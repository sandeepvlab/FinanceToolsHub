<form method="POST">
    <div class="grid">
        <label>ZIP Code:</label>
        <input type="text" name="zipcode" required>

        <label>Home Value ($):</label>
        <input type="number" name="home_value" min="0" required>

        <label>Down Payment:</label>
        <input type="number" name="down_payment" min="0" required>
        <select name="down_type">
            <option value="amount">$</option>
            <option value="percent">%</option>
        </select>

        <label>Loan Type:</label>
        <select name="loan_type" id="loan_type" onchange="updateLoanTerm()">
            <option value="conventional">Conventional</option>
            <option value="arm">ARM (Adjustable)</option>
        </select>

        <label>Loan Term (years):</label>
        <select name="loan_term" id="loan_term">
            <!-- Options will be updated by JavaScript -->
        </select>

        <label>Interest Rate (%):</label>
        <input type="number" step="0.01" name="interest_rate" min="0" value="0">

        <label>Property Tax ($/yr):</label>
        <input type="number" name="property_tax" min="0" value="3000">

        <label>Home Insurance ($/yr):</label>
        <input type="number" name="home_ins" min="0" value="1500">

        <label>Monthly HOA ($):</label>
        <input type="number" name="hoa" min="0" value="0">

        <button type="submit">Calculate</button>
    </div>
</form>

<script>
const loanTermSelect = document.getElementById("loan_term");

function updateLoanTerm() {
    const loanType = document.getElementById("loan_type").value;
    loanTermSelect.innerHTML = ""; // clear options

    if(loanType === "conventional") {
        [30,20,15,10].forEach(term => {
            let option = document.createElement("option");
            option.value = term;
            option.text = term + " years";
            loanTermSelect.add(option);
        });
    } else { // ARM
        [3,5,7,10].forEach(term => {
            let option = document.createElement("option");
            option.value = term;
            option.text = term + "-year initial fixed";
            loanTermSelect.add(option);
        });
    }
}

// Initialize loan term options on page load
updateLoanTerm();
</script>

{% if result %}
    {% if result.pmi_message %}
        <p style="color:red;"><strong>PMI Notice:</strong> {{ result.pmi_message }}</p>
    {% endif %}
{% endif %}
